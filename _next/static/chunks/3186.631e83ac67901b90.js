(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3186],{33186:function(e,t,n){"use strict";n.r(t),n.d(t,{GraphPlayround:function(){return ed}});var o=n(85893),r=n(91911),i=n(60938),s=n(81507),c=n(50254),a=n(68208),l=n(5233),d=n(92601);n(42222);var h=n(4373),u=n(21203),g=n(93060),p=n(16468),m=n(43671),b=n(48323),k=n(20178),v=n(83608),x=n.n(v),f=n(67294),C=n(46369);n(31126);let y=(0,d.Ge)("block");function j(e){var t;let{graph:n,block:r}=e;return(0,o.jsxs)(h.Je,{graph:n,block:r,className:y(),children:[r.anchors.map(e=>(0,o.jsx)(h.zg,{position:"absolute",graph:n,anchor:e},e.id)),(0,o.jsxs)(p.k,{grow:1,direction:"column",children:[(0,o.jsx)(b.x,{ellipsis:!0,variant:"caption-2",className:y("name"),children:r.name}),(0,o.jsx)(b.x,{ellipsis:!0,variant:"caption-1",color:"secondary",children:null===(t=r.meta)||void 0===t?void 0:t.description})]}),(0,o.jsx)(p.k,{children:(0,o.jsx)(c.z,{onClick:e=>e.stopPropagation(),children:(0,o.jsx)(m.J,{data:C.Z})})})]})}function S(e){let t=18*e;return e>=1&&(t+=8*e),t+18}class B extends h.lR{renderHTML(){return(0,o.jsx)(j,{graph:this.context.graph,block:this.connectedState.$state.value})}getAnchorPosition(e){var t;let n=this.getAnchorsYOffter(e.type),o=S((null===(t=this.connectedState.$anchorIndexs.value)||void 0===t?void 0:t.get(e.id))||0);return{x:e.type===h.TX.OUT?this.state.width:0,y:n+o}}renderMinimalisticBlock(e){this.renderBody(e),.1>this.context.camera.getCameraScale()||(e.fillStyle="rgba(255, 190, 92, 1)",function(e,t,n){t.save();let o=new Path2D(e.path),r=e.width/e.iniatialWidth,i=e.height/e.initialHeight;t.translate(n.x+n.width/2-e.width/2,n.y+n.height/2-e.height/2),t.scale(r,i),t.fill(o,"evenodd"),t.restore()}({path:"M5.75 2.5H10.25C10.7842 2.5 11.2532 2.77929 11.519 3.19983C10.6259 3.58121 10 4.46751 10 5.5C10 6.61941 10.7357 7.56698 11.75 7.88555V12C11.75 12.8284 11.0784 13.5 10.25 13.5H5.75C5.21576 13.5 4.74676 13.2207 4.48102 12.8002C5.3741 12.4188 6 11.5325 6 10.5C6 9.38059 5.26428 8.43302 4.25 8.11445V7.88555C5.26428 7.56698 6 6.61941 6 5.5C6 4.46751 5.3741 3.58121 4.48102 3.19982C4.74676 2.77929 5.21576 2.5 5.75 2.5ZM2.75 8.11445V7.88555C1.73572 7.56698 1 6.61941 1 5.5C1 4.32762 1.80699 3.34373 2.8958 3.0735C3.28617 1.87008 4.41648 1 5.75 1H10.25C11.5835 1 12.7138 1.87008 13.1042 3.07351C14.193 3.34373 15 4.32762 15 5.5C15 6.61941 14.2643 7.56698 13.25 7.88555V12C13.25 13.6569 11.9069 15 10.25 15H5.75C4.41647 15 3.28616 14.1299 2.8958 12.9265C1.80699 12.6563 1 11.6724 1 10.5C1 9.38059 1.73572 8.43302 2.75 8.11445ZM3.5 11.5C4.05228 11.5 4.5 11.0523 4.5 10.5C4.5 9.94771 4.05228 9.5 3.5 9.5C2.94772 9.5 2.5 9.94772 2.5 10.5C2.5 11.0523 2.94772 11.5 3.5 11.5ZM2.5 5.5C2.5 4.94772 2.94772 4.5 3.5 4.5C4.05228 4.5 4.5 4.94772 4.5 5.5C4.5 6.05228 4.05228 6.5 3.5 6.5C2.94772 6.5 2.5 6.05229 2.5 5.5ZM12.5 4.5C11.9477 4.5 11.5 4.94772 11.5 5.5C11.5 6.05229 11.9477 6.5 12.5 6.5C13.0523 6.5 13.5 6.05229 13.5 5.5C13.5 4.94772 13.0523 4.5 12.5 4.5Z",width:56,height:56,iniatialWidth:14,initialHeight:14},e,this.getContentRect()))}renderSchematicView(e){if(this.renderBody(e),this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]){var t;e.fillStyle=(null===(t=this.context.colors.block)||void 0===t?void 0:t.text)||"",e.textAlign="center",this.renderTextAtCenter(this.state.name,e)}}subscribe(e){let t=super.subscribe(e);return t.push(this.addEventListener("mouseenter",()=>{this.hovered=!0,this.performRender()}),this.addEventListener("mouseleave",()=>{this.hovered=!1,this.performRender()})),t}renderName(e){if(this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]){var t;e.fillStyle=(null===(t=this.context.colors.block)||void 0===t?void 0:t.text)||"",e.textAlign="center",this.renderText(this.state.name,e)}}getAnchorsYOffter(e){let t=this.connectedState.$state.value.anchors.filter(t=>t.type===e),{height:n}=this.getContentRect();return(n-S(t.length-1))/2}renderTextAtCenter(e,t){var n;let o=this.getContentRect(),r=this.context.camera.getCameraScale();t.fillStyle=(null===(n=this.context.colors.block)||void 0===n?void 0:n.text)||"",t.textAlign="center",t.textBaseline="top";let{lines:i,measures:s}=(0,h.If)(e,t,o,{font:"500 ".concat(9/r,"px YS Text"),lineHeight:9/r}),c=o.height/2-s.height/2;for(let e=0;e<i.length;e++){let[n,o,r]=i[e],s=Math.floor(r+c);t.fillText(n,o,s)}}renderBody(e){var t,n,o;let r=this.context.camera.getCameraScale();e.fillStyle=this.hovered?"rgba(57, 47, 57, 1)":(null===(t=this.context.colors.block)||void 0===t?void 0:t.background)||"",e.beginPath(),e.roundRect(this.state.x,this.state.y,this.state.width,this.state.height,8),e.fill(),this.state.selected?(e.lineWidth=Math.min(Math.round(2/r),12),e.strokeStyle=(null===(n=this.context.colors.block)||void 0===n?void 0:n.selectedBorder)||""):(e.lineWidth=Math.min(Math.round(1/r),12),e.strokeStyle=this.hovered?"rgba(229, 229, 229, 0.4)":(null===(o=this.context.colors.block)||void 0===o?void 0:o.border)||""),e.stroke(),e.closePath()}constructor(...e){super(...e),this.cursor="pointer",this.hovered=!1}}var N=n(34424),w=n(63764),I=n(66375);n(78941);let A="gravity";function T(e,t){let n=e.getValue(),o='"id": "'.concat(String(t),'"'),r=n.indexOf(o),i=n.lastIndexOf("{",r),s=n.indexOf("}",r),c=1,a=s+1;for(;c>0&&a<n.length;)"{"===n[a]?c++:"}"===n[a]&&c--,a++;return s=a,{start:e.getPositionAt(i),end:e.getPositionAt(s)}}w._m.init().then(e=>{!function(e){e.editor.defineTheme(A,{base:"vs-dark",inherit:!0,rules:[{token:"string.key.json",foreground:"#febe5c"}],colors:{"editor.foreground":"#ffdb4d4d","editor.background":"#251b25","editor.lineHighlightBackground":"#ffdb4d4d","editorLineNumber.foreground":"#bd5c0a","editor.selectionBackground":"#ffdb4d4d","editor.inactiveSelectionBackground":"#ffdb4d4d"}})}(e),function(e){e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemaValidation:"error",schemas:[{uri:"http://gravity/graph-playground/schema.json",fileMatch:["*"],schema:{type:"object",properties:{blocks:{type:"array",items:{$ref:"#/definitions/TBlock"},description:"List of blocks (TBlock[])"},connections:{type:"array",items:{$ref:"#/definitions/TConnection"},description:"List of connections (TConnection[])"}},required:["blocks","connections"],definitions:{TBlock:{type:"object",properties:{id:{type:"string",description:"Block identifier (TBlockId)"},is:{type:"string",description:"String representation of the block type"},x:{type:"number",description:"X coordinate"},y:{type:"number",description:"Y coordinate"},width:{type:"number",description:"Block width"},height:{type:"number",description:"Block height"},selected:{type:"boolean",description:"Flag indicating if the block is selected"},name:{type:"string",description:"Block name"},anchors:{type:"array",items:{$ref:"#/definitions/TAnchor"},description:"List of anchors (TAnchor[])"},meta:{type:"object",description:"Meta information (optional)"}},required:["id","is","x","y","width","height","selected","name","anchors"]},TConnection:{type:"object",properties:{sourceBlockId:{type:"string",description:"Identifier of the source block"},targetBlockId:{type:"string",description:"Identifier of the target block"},sourceAnchorId:{type:"string",description:"Identifier of the source anchor (optional)"},targetAnchorId:{type:"string",description:"Identifier of the target anchor (optional)"},label:{type:"string",description:"Connection label (optional)"},styles:{type:"object",properties:{dashes:{type:"array",items:{type:"number"},description:"Array of dash lengths for dashed lines (optional)"}},additionalProperties:!0,description:"Connection styles (optional)"},dashed:{type:"boolean",description:"Flag indicating if the line is dashed (optional)"},selected:{type:"boolean",description:"Flag indicating if the connection is selected (optional)"}},required:["sourceBlockId","targetBlockId"]},TAnchor:{type:"object",properties:{id:{type:"string",description:"Anchor identifier"},blockId:{type:"string",description:"Identifier of the block this anchor belongs to"},type:{type:"string",enum:["IN","OUT"],description:"Anchor type, either IN or OUT"},index:{type:"number",description:"Anchor index"}},required:["id","blockId","type"]}}}}]})}(e)});let L=(0,d.Ge)("editor"),z=f.forwardRef(function(e,t){let[n,r]=(0,f.useState)(),i=(0,f.useRef)(),s=(0,f.useRef)({blocks:[],connections:[]});(0,f.useImperativeHandle)(t,()=>({scrollTo:e=>{if(!i.current)return;let t=T(i.current.getModel(),e);if(null==t?void 0:t.start.column){var n;null===(n=i.current)||void 0===n||n.revealLinesInCenter(t.start.lineNumber,t.end.lineNumber,0)}i.current.setSelection({startColumn:t.start.column,startLineNumber:t.start.lineNumber,endColumn:t.end.column,endLineNumber:t.end.lineNumber})},updateBlocks:e=>{var t;let n=null===(t=i.current)||void 0===t?void 0:t.getModel();if(!n)return;let o=e.map(e=>{let t=T(n,e.id),o=JSON.stringify({block:[e]},null,2);return{range:{startColumn:t.start.column,startLineNumber:t.start.lineNumber,endColumn:t.end.column,endLineNumber:t.end.lineNumber},text:o.slice(19,o.length-6)}});n.applyEdits(o)},setContent:e=>{var t;let{blocks:n,connections:o}=e;s.current={blocks:n,connections:o},i.current&&(null===(t=i.current)||void 0===t||t.setValue(JSON.stringify(s.current,null,2)))}}));let a=(0,f.useCallback)(()=>{var t,n;let o=null===(t=i.current)||void 0===t?void 0:t.getModel();if(o)try{let t=JSON.parse(o.getValue());null==e||null===(n=e.onChange)||void 0===n||n.call(e,{blocks:t.blocks,connections:t.conections})}catch(e){console.error(e)}},[i]);return(0,o.jsxs)(p.k,{direction:"column",className:L(),children:[(0,o.jsx)(p.k,{grow:1,children:(0,o.jsx)(w.ML,{onMount:e=>{var t;i.current=e,null===(t=i.current)||void 0===t||t.setValue(JSON.stringify(s.current,null,2)),e.addCommand(I.DC.CtrlCmd|I.VD.Enter,a)},onValidate:e=>{r(e.filter(e=>8===e.severity)[0]||null)},language:"json",theme:A,options:{contextmenu:!1,lineNumbersMinChars:4,glyphMargin:!1,fontSize:18,lineHeight:20,colorDecorators:!0,minimap:{enabled:!1},smoothScrolling:!0,"bracketPairColorization.editor":!0}})}),(0,o.jsxs)(p.k,{className:L("actions"),gap:3,children:[(0,o.jsxs)(c.z,{size:"l",disabled:!!n,view:"action",onClick:a,children:["Apply ",(0,o.jsx)(N.q,{className:L("hotkey"),view:"light",value:"mod+enter"})]}),(0,o.jsx)(c.z,{size:"l",disabled:!!n,onClick:e.addBlock,children:"Add Block"}),n&&(0,o.jsx)(p.k,{grow:1,alignItems:"center",justifyContent:"flex-end",children:(0,o.jsx)(b.x,{color:"danger",children:(0,o.jsx)("span",{style:{cursor:"pointer"},onClick:()=>{var e,t;null===(e=i.current)||void 0===e||e.revealLinesInCenter(n.startLineNumber,n.endLineNumber,0),null===(t=i.current)||void 0===t||t.setSelection({startColumn:n.startColumn,startLineNumber:n.startLineNumber,endColumn:n.endColumn,endLineNumber:n.endLineNumber})},children:n.message})})})]})]})});n(4722);var M=n(852),E=n(555);n(64286);let R=[{value:"bezier",content:"Bezier"},{value:"line",content:"Line"}],F=[{value:"bezier",content:"Show"},{value:"line",content:"Hide"}],H=(0,d.Ge)("graph-settings");function J(e){let{className:t,radionButtonClass:n,graph:r}=e,i=function(){let[e,t]=(0,f.useState)(Date.now());return(0,f.useCallback)(()=>{t(Date.now())},[])}(),s=(0,f.useRef)(null),[a,l]=(0,f.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.z,{size:"l",view:a?"action":"raised",className:t,ref:s,onClick:()=>l(e=>!e),children:(0,o.jsx)(m.J,{data:M.Z})}),(0,o.jsx)(E.G,{anchorRef:s,open:a,onClose:()=>l(!1),placement:["right-end"],children:(0,o.jsxs)(p.k,{direction:"column",className:H("popup"),gap:3,children:[(0,o.jsx)(b.x,{variant:"subheader-2",children:"Graph settings"}),(0,o.jsxs)(p.k,{direction:"column",gap:2,children:[(0,o.jsx)(b.x,{variant:"subheader-1",children:"Connection type"}),(0,o.jsx)(k.E,{className:n,size:"l",onUpdate:e=>{r.updateSettings({useBezierConnections:e===R[0].value}),i()},value:R[r.rootStore.settings.getConfigFlag("useBezierConnections")?0:1].value,options:R})]}),(0,o.jsxs)(p.k,{direction:"column",gap:2,children:[(0,o.jsx)(b.x,{variant:"subheader-1",children:"Show arrows"}),(0,o.jsx)(k.E,{size:"l",className:n,onUpdate:e=>{r.updateSettings({showConnectionArrows:e===F[0].value}),i()},value:F[r.rootStore.settings.getConfigFlag("showConnectionArrows")?0:1].value,options:F})]})]})})]})}var Z=n(20522);n(86839);let O=(0,d.Ge)("text-block");function V(e){var t;let{graph:n,block:r}=e;return(0,o.jsx)(h.Je,{graph:n,block:r,className:O(),children:(0,o.jsxs)(p.k,{direction:"row",gap:2,alignItems:"center",grow:1,children:[(0,o.jsx)(m.J,{className:O("icon"),data:Z.Z,size:18}),(0,o.jsx)(b.x,{className:O("text"),ellipsis:!0,variant:"body-1",children:null===(t=r.meta)||void 0===t?void 0:t.text})]})})}class D extends h.lR{renderHTML(){return(0,o.jsx)(V,{graph:this.context.graph,block:this.connectedState.$state.value})}renderMinimalisticBlock(e){this.renderBody(e)}renderSchematicView(e){this.renderBody(e),this.context.camera.getCameraScale()>this.context.constants.block.SCALES[0]&&this.renderName(e)}subscribe(e){let t=super.subscribe(e);return t.push(this.addEventListener("mouseenter",()=>{this.hovered=!0,this.performRender()}),this.addEventListener("mouseleave",()=>{this.hovered=!1,this.performRender()})),t}renderName(e){var t;e.fillStyle="rgba(189, 142, 75, 1)",e.textAlign="center",this.renderText((null===(t=this.state.meta)||void 0===t?void 0:t.text)||"",e)}renderTextAtCenter(e,t){let n=this.getContentRect(),o=this.context.camera.getCameraScale();t.fillStyle="rgba(189, 142, 75, 1)",t.textAlign="center",t.textBaseline="bottom";let{lines:r,measures:i}=(0,h.If)(e,t,n,{font:"500 ".concat(13/o,"px YS Text"),lineHeight:9/o}),s=n.height/2-i.height/2;for(let e=0;e<r.length;e++){let[n,o,i]=r[e],c=Math.round(i+s);t.fillText(n,o,c)}}renderBody(e){let t=this.context.camera.getCameraScale();e.save(),e.lineWidth=Math.min(Math.round(2/t),12),e.fillStyle="rgba(189, 142, 75, 0.1)",e.beginPath(),e.roundRect(this.state.x,this.state.y,this.state.width,this.state.height,8),e.fill(),this.state.selected?e.lineWidth=Math.min(Math.round(2/t),12):(e.lineWidth=2,e.setLineDash([4,4])),e.strokeStyle="rgba(189, 142, 75, 1)",e.stroke(),e.closePath(),e.restore()}constructor(...e){super(...e),this.cursor="pointer",this.hovered=!1}}var P=n(65474),_=n(76949),G=n(42991),$=n(40954);function U(e){let{className:t,graph:n}=e,[r,i]=(0,f.useState)(1);return(0,h.sF)(n,"camera-change",e=>{let{scale:t}=e;i(t)}),(0,o.jsxs)(p.k,{grow:1,justifyContent:"center",className:t,direction:"column",children:[(0,o.jsx)($.u,{content:"Zoom in",placement:"right",children:(0,o.jsx)(c.z,{size:"l",view:"raised",onClick:()=>{n.zoom({scale:n.cameraService.getCameraScale()+.08})},disabled:r>=n.cameraService.getCameraState().scaleMax,children:(0,o.jsx)(m.J,{data:P.Z})})}),(0,o.jsx)($.u,{content:"Fit to viewport",placement:"right",children:(0,o.jsx)(c.z,{size:"l",view:"raised",onClick:()=>{n.zoomTo("center")},children:(0,o.jsx)(m.J,{data:_.Z})})}),(0,o.jsx)($.u,{content:"Zoom out",placement:"right",children:(0,o.jsx)(c.z,{size:"l",view:"raised",onClick:()=>{n.zoom({scale:n.cameraService.getCameraScale()-.08})},disabled:r<=n.cameraService.getCameraState().scaleMin,children:(0,o.jsx)(m.J,{data:G.Z})})})]})}let X="block-action",W="block-text";function q(e){return"action_".concat(e)}function Y(e,t,n){let o=q(n);return{is:X,id:o,x:e,y:t,width:126,height:126,selected:!1,name:"Block #".concat(n),anchors:[{id:"".concat(o,"_in"),blockId:o,type:h.TX.IN},{id:"".concat(o,"_out"),blockId:o,type:h.TX.OUT}],meta:{description:"Description"}}}function Q(e,t,n,o,r){return{is:W,id:"text_".concat(o),x:e,y:t,width:n,height:48,selected:!1,name:"Text Block",anchors:[],meta:{text:r}}}function K(e,t){return Math.round(Math.random()*(t-e)+e)}function ee(e,t){let n={blocks:[],connections:[]},o=[],r=0;for(let i=0;i<=e;i++){let s=i**2;i>=e/2&&(s=(e-i)**2);let c=(500-200*s)/2,a=500*i*2.5,l=[];for(let e=0;e<=s;e++){let t=Y(a,c+200*e,++r);n.blocks.push(t),l.push(t)}if(i>1){for(let e=0;e<=t;e++){let e=K(n.blocks.length-l.length-o.length-1,n.blocks.length-l.length-1),t=K(n.blocks.length-l.length-1,n.blocks.length-1);if(e!==t){let o=q(e),r=q(t);n.connections.push({sourceBlockId:o,sourceAnchorId:"".concat(o,"_anchor_out"),targetBlockId:r,targetAnchorId:"".concat(r,"_anchor_in")})}}o=[...l]}}return n}let et=(0,d.Ge)("graph-playground"),en=(0,d.Ge)("graph-playground-radio-buton"),eo=ee(0,5),er=[Q(-144,80,448,0,"To create new block, drag and drop new connection from edge"),Q(-64,160,240,1,"Use scroll to zoom in or out")],ei={viewConfiguration:{colors:{selection:{background:"rgba(255, 190, 92, 0.1)",border:"rgba(255, 190, 92, 1)"},connection:{background:"rgba(255, 255, 255, 0.5)",selectedBackground:"rgba(234, 201, 74, 1)"},block:{background:"rgba(37, 27, 37, 1)",border:"rgba(229, 229, 229, 0.2)",selectedBorder:"rgba(255, 190, 92, 1)",text:"rgba(255, 255, 255, 1)"},anchor:{background:"rgba(255, 190, 92, 1)"},canvas:{layerBackground:"rgba(22, 13, 27, 1)",belowLayerBackground:"rgba(22, 13, 27, 1)",dots:"rgba(255, 255, 255, 0.2)",border:"rgba(255, 255, 255, 0.3)"}},constants:{block:{SCALES:[.1,.2,.5]}}},settings:{canDragCamera:!0,canZoomCamera:!0,canDuplicateBlocks:!1,canChangeBlockGeometry:h.Q7.ALL,canCreateNewConnections:!1,showConnectionArrows:!1,scaleFontSize:1,useBezierConnections:!0,useBlocksAnchors:!0,showConnectionLabels:!1,blockComponents:{[X]:B,[W]:D}}},es=[{value:"1",content:"1"},{value:"100",content:"100"},{value:"1000",content:"1 000"},{value:"10000",content:"10 000"}];function ec(e){let t=(0,f.useRef)(e);return t.current=e,(0,f.useCallback)(function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.current(...n)},[])}function ea(e){let{className:t}=e,{graph:n,setEntities:r,updateEntities:i,start:s}=(0,h.n4)(ei),a=(0,f.useRef)(null),[l,d]=(0,f.useState)(!0),v=ec(()=>{var e;let t=n.rootStore.getAsConfig();null===(e=a.current)||void 0===e||e.setContent({blocks:t.blocks||[],connections:t.connections||[]})});(0,h.sF)(n,"block-change",e=>{var t,n;let{block:o}=e;null===(t=a.current)||void 0===t||t.updateBlocks([o]),null===(n=a.current)||void 0===n||n.scrollTo(o.id)}),(0,h.sF)(n,"blocks-selection-change",e=>{var t;let{changes:o}=e;null===(t=a.current)||void 0===t||t.updateBlocks([...o.add.map(e=>({...n.rootStore.blocksList.getBlock(e),selected:!0})),...o.removed.map(e=>({...n.rootStore.blocksList.getBlock(e),selected:!1}))])}),(0,h.sF)(n,"connection-created",(e,t)=>{let{sourceBlockId:o,sourceAnchorId:r,targetBlockId:i,targetAnchorId:s}=e;t.preventDefault(),r&&(n.rootStore.blocksList.getBlockState(o).getAnchorById(r).state.type===h.TX.IN?n.api.addConnection({sourceBlockId:i,sourceAnchorId:s,targetBlockId:o,targetAnchorId:r}):n.api.addConnection({sourceBlockId:o,sourceAnchorId:r,targetBlockId:i,targetAnchorId:s}),v())}),(0,h.sF)(n,"connection-create-drop",e=>{var t;let o,{sourceBlockId:r,sourceAnchorId:i,targetBlockId:s,point:c}=e;s||(n.rootStore.blocksList.getBlockState(r).getAnchorById(i).state.type===h.TX.IN?(o=Y(c.x-126,c.y-63,n.rootStore.blocksList.$blocksMap.value.size+1),n.api.addBlock(o),n.api.addConnection({sourceBlockId:o.id,sourceAnchorId:o.anchors[1].id,targetBlockId:r,targetAnchorId:i})):(o=Y(c.x,c.y-63,n.rootStore.blocksList.$blocksMap.value.size+1),n.api.addBlock(o),n.api.addConnection({sourceBlockId:r,sourceAnchorId:i,targetBlockId:o.id,targetAnchorId:o.anchors[0].id})),n.zoomTo([o.id],{transition:250}),v(),null===(t=a.current)||void 0===t||t.scrollTo(o.id))}),(0,f.useLayoutEffect)(()=>{r({blocks:[...er,...eo.blocks],connections:eo.connections}),v()},[r]),(0,h.sF)(n,"state-change",e=>{let{state:t}=e;t===h.VM.ATTACHED&&(s(),n.zoomTo("center",{padding:300}))});let C=ec(()=>{var e;let t=n.rootStore.blocksList.getUsableRect(),o=Y(x()(t.x,t.x+t.width+100),x()(t.y,t.y+t.height+100),n.rootStore.blocksList.$blocksMap.value.size+1);n.api.addBlock(o),n.zoomTo([o.id],{transition:250}),v(),null===(e=a.current)||void 0===e||e.scrollTo(o.id)}),y=ec((e,t)=>{var n;let r=null===(n=e.rootStore.blocksList.getBlockState(t.id))||void 0===n?void 0:n.getViewComponent();return r instanceof B||r instanceof D?r.renderHTML():(0,o.jsxs)(h.Je,{graph:e,block:t,children:["Unknown block ",(0,o.jsx)(o.Fragment,{children:t.id})]})});(0,h.sF)(n,"blocks-selection-change",e=>{let{list:t}=e;if(1===t.length){var n;null===(n=a.current)||void 0===n||n.scrollTo(t[0])}}),(0,f.useEffect)(()=>{let e=e=>{"Backspace"===e.code&&(n.api.deleteSelected(),v())};return document.body.addEventListener("keydown",e),()=>document.body.removeEventListener("keydown",e)});let j=async e=>{let t;switch(e){case es[0].value:t=ee(0,5);break;case es[1].value:t=ee(10,100);break;case es[2].value:t=ee(23,150),d(!1);break;case es[3].value:n.updateSettings({useBezierConnections:!1}),d(!1),t=ee(50,150)}t&&(await new Promise(e=>setTimeout(e,200)),r({blocks:null==t?void 0:t.blocks,connections:null==t?void 0:t.connections}),n.zoomTo("center",{transition:500}),v())};return(0,o.jsxs)(p.k,{className:et(null,t),gap:l?8:0,children:[(0,o.jsx)(c.z,{className:et("layout-button"),onClick:()=>d(!l),children:(0,o.jsx)(m.J,{data:l?u.Z:g.Z})}),(0,o.jsxs)(p.k,{direction:"column",grow:1,className:et("content",{graph:!0}),gap:6,children:[(0,o.jsxs)(p.k,{direction:"row",gap:4,alignItems:"center",children:[(0,o.jsx)(b.x,{variant:"header-1",className:et("title"),children:"Blocks"}),(0,o.jsx)(k.E,{className:en(),options:es,onUpdate:j,size:"l"})]}),(0,o.jsxs)(p.k,{grow:1,className:et("view",{"graph-editor":!0}),children:[(0,o.jsxs)(p.k,{className:et("graph-tools"),direction:"column",children:[(0,o.jsx)(U,{graph:n,className:et("zoom","button-group")}),(0,o.jsx)(J,{className:et("graph-settings"),radionButtonClass:en(),graph:n})]}),(0,o.jsx)(h.uR,{graph:n,renderBlock:y})]})]}),(0,o.jsxs)(p.k,{direction:"column",grow:1,className:et("content",{editor:!0,hidden:!l}),gap:6,children:[(0,o.jsx)(b.x,{variant:"header-1",className:et("title"),children:"JSON Editor"}),(0,o.jsx)(p.k,{grow:1,className:et("view",{"config-editor":!0}),children:(0,o.jsx)(z,{ref:a,onChange:e=>{let{blocks:t,connections:n}=e;i({blocks:t,connections:n})},addBlock:C})})]})]})}let el=(0,d.Ge)("graph"),ed=()=>{let{t:e,i18n:t}=(0,l.$G)("graph");return(0,o.jsxs)(r.r,{className:el(),containerClass:el("container"),children:[(0,o.jsx)(i.X,{className:el("title"),children:(0,o.jsxs)(s.J,{sizes:12,className:el("heading"),children:[(0,o.jsx)("h1",{className:el("title"),children:e("title")}),(0,o.jsx)("div",{className:el("actions"),children:(0,o.jsx)(c.z,{href:(0,d.n6)("/libraries/graph",t),className:el("library-button"),size:"xl",view:"outlined-contrast",children:e("goToLibrary")})})]})}),(0,o.jsx)(i.X,{className:el("playground"),children:(0,o.jsx)(a.f,{theme:"dark",children:(0,o.jsx)(ea,{className:el("graph-viewer")})})})]})}},42222:function(){},31126:function(){},78941:function(){},4722:function(){},64286:function(){},86839:function(){}}]);